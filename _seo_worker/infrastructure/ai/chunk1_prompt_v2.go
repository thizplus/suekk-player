package ai

import (
	"fmt"
	"strings"

	"github.com/google/generative-ai-go/genai"
	"seo-worker/domain/ports"
)

// ============================================================================
// Chunk 1 (V2): Core Identity
// Focus: ‡∏™‡∏£‡πâ‡∏≤‡∏á "‡πÅ‡∏Å‡πà‡∏ô" ‡∏Ç‡∏≠‡∏á‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô Context ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Chunk ‡∏≠‡∏∑‡πà‡∏ô
// Persona: ‡∏ô‡∏±‡∏Å‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô SEO ‡∏°‡∏∑‡∏≠‡∏≠‡∏≤‡∏ä‡∏µ‡∏û
// ============================================================================

// buildChunk1SchemaV2 ‡∏™‡∏£‡πâ‡∏≤‡∏á JSON Schema ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Chunk 1 V2
func (c *GeminiClient) buildChunk1SchemaV2() *genai.Schema {
	return &genai.Schema{
		Type: genai.TypeObject,
		Properties: map[string]*genai.Schema{
			// === Core SEO ===
			"title": {
				Type:        genai.TypeString,
				Description: "H1 title ‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ 50-60 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ ‡∏î‡∏∂‡∏á‡∏î‡∏π‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ô‡πÉ‡∏à",
			},
			"metaTitle": {
				Type:        genai.TypeString,
				Description: "Meta title ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Google ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ [‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á] ‡πÅ‡∏•‡∏∞ [‡∏ã‡∏±‡∏ö‡πÑ‡∏ó‡∏¢] ‡πÉ‡∏ô 60 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÅ‡∏£‡∏Å",
			},
			"metaDescription": {
				Type:        genai.TypeString,
				Description: "Meta description 150-160 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ ‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏•‡∏¥‡∏Å",
			},

			// === Content Summary ===
			"summary": {
				Type:        genai.TypeString,
				Description: "‚ö†Ô∏è ‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ 400-500 ‡∏Ñ‡∏≥ ‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô 4-6 ‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤ (‡∏Ñ‡∏±‡πà‡∏ô‡∏î‡πâ‡∏ß‡∏¢ \\n\\n) ‡πÄ‡∏ô‡πâ‡∏ô‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å ‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏¢‡∏â‡∏≤‡∏Å‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç",
			},
			"summaryShort": {
				Type:        genai.TypeString,
				Description: "üéØ TTS Teaser Script 80-120 ‡∏Ñ‡∏≥ - ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÅ‡∏ö‡∏ö YouTuber/TikToker ‡∏û‡∏π‡∏î‡πÄ‡∏õ‡∏¥‡∏î‡∏Ñ‡∏•‡∏¥‡∏õ ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô (‡∏à‡∏∞‡πÄ‡∏Å‡∏¥‡∏î‡∏≠‡∏∞‡πÑ‡∏£‡∏Ç‡∏∂‡πâ‡∏ô?, ‡∏•‡∏≠‡∏á‡∏à‡∏¥‡∏ô‡∏ï‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡∏î‡∏π, ‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠) ‡∏´‡πâ‡∏≤‡∏°‡∏™‡∏õ‡∏≠‡∏¢‡∏•‡πå‡∏ï‡∏≠‡∏ô‡∏à‡∏ö ‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏≤‡∏Å‡∏î‡∏π!",
			},

			// === Thumbnail ===
			"thumbnailAlt": {
				Type:        genai.TypeString,
				Description: "Alt text ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö thumbnail 20-30 ‡∏Ñ‡∏≥",
			},

			// === Quality ===
			"qualityScore": {
				Type:        genai.TypeInteger,
				Description: "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û 1-10 (‡∏î‡∏π‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡πÉ‡∏ô prompt) - ‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏´‡πâ 9-10 ‡∏ó‡∏∏‡∏Å‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á ‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏±‡∏á",
			},

			// === Theme/Tone (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö CoreContext) ===
			"mainTheme": {
				Type:        genai.TypeString,
				Description: "‡∏ò‡∏µ‡∏°‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á ‡πÄ‡∏ä‡πà‡∏ô '‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏™‡∏≠‡∏á‡∏î‡πâ‡∏≤‡∏ô', '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö', '‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏û‡∏ö‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á'",
			},
			"mainTone": {
				Type:        genai.TypeString,
				Description: "‡πÇ‡∏ó‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á ‡πÄ‡∏ä‡πà‡∏ô '‡∏ú‡πà‡∏≠‡∏ô‡∏Ñ‡∏•‡∏≤‡∏¢', '‡πÄ‡∏¢‡πâ‡∏≤‡∏¢‡∏ß‡∏ô', '‡∏ã‡∏µ‡πÄ‡∏£‡∏µ‡∏¢‡∏™', '‡πÇ‡∏£‡πÅ‡∏°‡∏ô‡∏ï‡∏¥‡∏Å'",
			},
		},
		Required: []string{
			"title", "metaTitle", "metaDescription",
			"summary", "summaryShort", "thumbnailAlt",
			"qualityScore", "mainTheme", "mainTone",
		},
	}
}

// buildChunk1PromptV2 ‡∏™‡∏£‡πâ‡∏≤‡∏á prompt ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Chunk 1 V2
func (c *GeminiClient) buildChunk1PromptV2(input *ports.AIInput) string {
	// ‡∏™‡∏£‡πâ‡∏≤‡∏á cast names string
	castNames := make([]string, len(input.Casts))
	for i, cast := range input.Casts {
		castNames[i] = cast.Name
	}
	castNamesStr := strings.Join(castNames, ", ")

	return fmt.Sprintf(`[PERSONA]
‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠ "‡∏ô‡∏±‡∏Å‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô SEO ‡∏°‡∏∑‡∏≠‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡∏£‡∏∞‡∏î‡∏±‡∏ö Premium"
- ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡∏Å‡∏≤‡∏£‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏ö‡πÉ‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
- ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥ ‡πÑ‡∏°‡πà‡πÅ‡∏Ç‡πá‡∏á‡∏ó‡∏∑‡πà‡∏≠

[TASK - ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô]
‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠: ‡∏™‡∏£‡πâ‡∏≤‡∏á "‡πÅ‡∏Å‡πà‡∏ô" ‡∏Ç‡∏≠‡∏á‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏° (Core Identity) ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô Context ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Chunk ‡∏≠‡∏∑‡πà‡∏ô
‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£: Title, Summary, Theme, Tone ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô

---

## ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Input

### SRT Transcript:
%s

### Video Metadata:
- Code: %s
- Duration: %d seconds
- Casts: %s

---

## ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è ‡∏Å‡∏é‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (CRITICAL RULES) ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è

### 1. summary ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏ö‡πà‡∏á‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤ (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å!)
- ‚úÖ ‡πÉ‡∏ä‡πâ [PARA] ‡∏Ñ‡∏±‡πà‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤ (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà \n)
- ‚úÖ ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ 4-6 ‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤ ‡∏Ñ‡∏±‡πà‡∏ô‡∏î‡πâ‡∏ß‡∏¢ [PARA]
- ‚úÖ ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤ 80-100 ‡∏Ñ‡∏≥
- ‚ùå ‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ï‡∏¥‡∏î‡∏Å‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß (REJECT!)

### 2. summary ‡∏ï‡πâ‡∏≠‡∏á‡∏¢‡∏≤‡∏ß 400-500 ‡∏Ñ‡∏≥
- ‚ùå ‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏™‡∏±‡πâ‡∏ô‡πÜ 50-200 ‡∏Ñ‡∏≥ (‡∏à‡∏∞‡∏ñ‡∏π‡∏Å REJECT!)
- ‚úÖ ‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏¢‡∏â‡∏≤‡∏Å‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏∏‡∏Å‡∏â‡∏≤‡∏Å ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å

### 3. ‡∏´‡πâ‡∏≤‡∏°‡∏ú‡∏™‡∏°‡∏†‡∏≤‡∏©‡∏≤‡πÉ‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÅ‡∏™‡∏î‡∏á
- ‚úÖ ‡πÉ‡∏ä‡πâ‡∏ä‡∏∑‡πà‡∏≠ ENGLISH ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏°‡∏≤‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô: %s
- ‚ùå ‡∏´‡πâ‡∏≤‡∏°: "‡πÄ‡∏ã‡πá‡∏ô‡∏°‡∏∞ Mami", "Zemba ‡∏°‡∏≤‡∏°‡∏¥" (REJECT ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ!)

### 4. mainTheme ‡πÅ‡∏•‡∏∞ mainTone ‡∏ï‡πâ‡∏≠‡∏á‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
- mainTheme: ‡∏ò‡∏µ‡∏°‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á 1-3 ‡∏Ñ‡∏≥
- mainTone: ‡πÇ‡∏ó‡∏ô‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏´‡∏•‡∏±‡∏Å 1-3 ‡∏Ñ‡∏≥
- ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô Context ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Chunk ‡∏≠‡∏∑‡πà‡∏ô

---

## Output Requirements

1. **title**: H1 ‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ 50-60 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£
2. **metaTitle**: ‚ö†Ô∏è MUST ‡∏°‡∏µ "[%s]" ‡πÅ‡∏•‡∏∞ "[‡∏ã‡∏±‡∏ö‡πÑ‡∏ó‡∏¢]" ‡πÄ‡∏ä‡πà‡∏ô "[FNS-172] Megami Jun ‡∏ã‡∏±‡∏ö‡πÑ‡∏ó‡∏¢: ..."
3. **metaDescription**: 150-160 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ ‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏•‡∏¥‡∏Å
4. **summary**: ‚ö†Ô∏è 400-500 ‡∏Ñ‡∏≥ ‡πÅ‡∏ö‡πà‡∏á 4-6 ‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤ (‡∏Ñ‡∏±‡πà‡∏ô‡∏î‡πâ‡∏ß‡∏¢ [PARA])
5. **summaryShort**: 80-120 ‡∏Ñ‡∏≥ ‡πÅ‡∏ö‡∏ö TTS Teaser (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å!)
   - ‚ö†Ô∏è ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÅ‡∏ö‡∏ö YouTuber/TikToker ‡∏û‡∏π‡∏î‡πÄ‡∏õ‡∏¥‡∏î‡∏Ñ‡∏•‡∏¥‡∏õ
   - ‚úÖ ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô: "‡∏à‡∏∞‡πÄ‡∏Å‡∏¥‡∏î‡∏≠‡∏∞‡πÑ‡∏£‡∏Ç‡∏∂‡πâ‡∏ô?", "‡∏•‡∏≠‡∏á‡∏à‡∏¥‡∏ô‡∏ï‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡∏î‡∏π‡∏™‡∏¥", "‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠"
   - ‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏¢‡∏≤‡∏Å‡∏£‡∏π‡πâ: "‡πÅ‡∏ï‡πà‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πà‡∏≠‡∏°‡∏≤...", "‡πÄ‡∏ò‡∏≠‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡πÄ‡∏•‡∏¢‡∏ß‡πà‡∏≤..."
   - ‚úÖ ‡πÉ‡∏ä‡πâ‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå: ‡∏ï‡∏∑‡πà‡∏ô‡πÄ‡∏ï‡πâ‡∏ô, ‡∏•‡∏∏‡πâ‡∏ô, ‡πÄ‡∏£‡πâ‡∏≤‡πÉ‡∏à
   - ‚ùå ‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÅ‡∏ö‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô/‡∏™‡∏≤‡∏£‡∏Ñ‡∏î‡∏µ
6. **thumbnailAlt**: Alt text 20-30 ‡∏Ñ‡∏≥
7. **qualityScore**: ‚ö†Ô∏è ‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô 1-10 ‡∏ï‡∏≤‡∏°‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á (‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏´‡πâ 9-10 ‡∏ó‡∏∏‡∏Å‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á!)
8. **mainTheme**: ‡∏ò‡∏µ‡∏°‡∏´‡∏•‡∏±‡∏Å 1-3 ‡∏Ñ‡∏≥ (‡πÄ‡∏ä‡πà‡∏ô "‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏™‡∏≠‡∏á‡∏î‡πâ‡∏≤‡∏ô")
9. **mainTone**: ‡πÇ‡∏ó‡∏ô‡∏´‡∏•‡∏±‡∏Å 1-3 ‡∏Ñ‡∏≥ (‡πÄ‡∏ä‡πà‡∏ô "‡∏ú‡πà‡∏≠‡∏ô‡∏Ñ‡∏•‡∏≤‡∏¢")

---

## üéØ ‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô qualityScore (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å!)

### ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô:
- **9-10 (Masterpiece)**: ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°, ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å, ‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏û‡∏™‡∏ß‡∏¢, ‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏•‡∏∂‡∏Å‡∏ã‡∏∂‡πâ‡∏á (‡∏´‡∏≤‡∏¢‡∏≤‡∏Å ~5%)
- **7-8 (‡∏î‡∏µ‡∏°‡∏≤‡∏Å)**: ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à, ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏î‡∏µ, ‡∏°‡∏µ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô (~30%)
- **5-6 (‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á)**: ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤, ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏û‡∏≠‡πÉ‡∏ä‡πâ, ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡πÇ‡∏î‡∏î‡πÄ‡∏î‡πà‡∏ô (~40%)
- **3-4 (‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô)**: ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏≠‡πà‡∏≠‡∏ô, ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡πÑ‡∏°‡πà‡∏ô‡πà‡∏≤‡∏õ‡∏£‡∏∞‡∏ó‡∏±‡∏ö‡πÉ‡∏à (~20%)
- **1-2 (‡πÅ‡∏¢‡πà)**: ‡πÑ‡∏°‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (~5%)

### ‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤:
1. **‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à‡∏Ç‡∏≠‡∏á‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á (40%)**: Plot twist? ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô? ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ö‡∏ö‡πÅ‡∏ú‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ?
2. **‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á (30%)**: ‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏™‡∏°‡∏à‡∏£‡∏¥‡∏á? ‡∏°‡∏µ chemistry? ‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏Ç‡πá‡∏á‡∏ó‡∏∑‡πà‡∏≠?
3. **‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏û/‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏Å‡∏≤‡∏® (20%)**: ‡∏°‡∏∏‡∏°‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à? ‡πÅ‡∏™‡∏á‡∏™‡∏ß‡∏¢? ‡∏´‡∏£‡∏∑‡∏≠‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤?
4. **‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ö‡∏ó‡∏™‡∏ô‡∏ó‡∏ô‡∏≤ (10%)**: ‡∏ö‡∏ó‡∏û‡∏π‡∏î‡∏î‡∏µ? ‡∏´‡∏£‡∏∑‡∏≠‡∏ô‡πà‡∏≤‡πÄ‡∏ö‡∏∑‡πà‡∏≠?

### ‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏´‡πâ‡∏≤‡∏°:
- ‚ùå ‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏´‡πâ 9-10 ‡∏ó‡∏∏‡∏Å‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á (‡∏ñ‡πâ‡∏≤‡∏ó‡∏∏‡∏Å‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏µ = ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÑ‡∏´‡∏ô‡∏î‡∏µ)
- ‚ùå ‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏à‡∏î‡∏µ ‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏±‡∏á
- ‚úÖ ‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏´‡∏ç‡πà‡∏Ñ‡∏ß‡∏£‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà 5-7 (‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢)

---

## ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á summary ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡πÉ‡∏ä‡πâ [PARA] ‡∏Ñ‡∏±‡πà‡∏ô‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤)

"‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏ß‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠ [‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£] ‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏°‡∏≤‡∏ñ‡∏∂‡∏á [‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà] ‡πÅ‡∏•‡∏∞‡πÑ‡∏î‡πâ‡∏û‡∏ö‡∏Å‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏Ñ‡∏≤‡∏î‡∏Ñ‡∏¥‡∏î ‡πÄ‡∏ò‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ú‡∏ä‡∏¥‡∏ç‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤ [PARA] ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô ‡πÄ‡∏ò‡∏≠‡πÑ‡∏î‡πâ‡∏û‡∏ö‡∏Å‡∏±‡∏ö [‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£‡∏≠‡∏∑‡πà‡∏ô] ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏°‡∏µ‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÉ‡∏ô‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏Ç‡∏≠‡∏á‡πÄ‡∏ò‡∏≠ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏û‡∏ß‡∏Å‡πÄ‡∏Ç‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ä‡πâ‡∏≤‡πÜ [PARA] ‡∏â‡∏≤‡∏Å‡πÑ‡∏Æ‡πÑ‡∏•‡∏ó‡πå‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏∑‡∏≠‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πà‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡∏π‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏Å‡∏•‡πâ‡∏ä‡∏¥‡∏î ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏ó‡∏µ‡πà‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏≠‡∏≠‡∏Å‡∏°‡∏≤ [PARA] ‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ‡∏ô‡∏≥‡πÄ‡∏™‡∏ô‡∏≠‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πà‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏°‡∏î‡∏∏‡∏•‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á"

---

## ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á summaryShort ‡∏ó‡∏µ‡πà‡∏î‡∏µ (TTS Teaser)

‚ùå ‡πÅ‡∏ö‡∏ö‡∏ô‡πà‡∏≤‡πÄ‡∏ö‡∏∑‡πà‡∏≠ (‡∏´‡πâ‡∏≤‡∏°!):
"Megami Jun ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏Å‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏´‡∏°‡∏≠ ‡∏û‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÑ‡∏ß‡∏ï‡πà‡∏≠‡∏™‡∏¥‡πà‡∏á‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡πÑ‡∏õ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î"

‚úÖ ‡πÅ‡∏ö‡∏ö‡∏ï‡∏∑‡πà‡∏ô‡πÄ‡∏ï‡πâ‡∏ô (‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£!):
"‡∏•‡∏≠‡∏á‡∏à‡∏¥‡∏ô‡∏ï‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡∏î‡∏π‡∏™‡∏¥ ‡∏ñ‡πâ‡∏≤‡πÅ‡∏Ñ‡πà‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™‡πÄ‡∏ö‡∏≤‡πÜ ‡∏Å‡πá‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏π‡∏ç‡πÄ‡∏™‡∏µ‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á? ‡∏ô‡∏±‡πà‡∏ô‡∏Ñ‡∏∑‡∏≠‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà Megami Jun ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ú‡∏ä‡∏¥‡∏ç‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô! ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏ò‡∏≠‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡πÄ‡∏Ç‡πâ‡∏≤‡∏û‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏´‡∏°‡∏≠ ‡πÅ‡∏ï‡πà‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ô‡∏µ‡πâ... ‡∏Å‡∏•‡∏±‡∏ö‡∏û‡∏≤‡πÄ‡∏ò‡∏≠‡πÑ‡∏õ‡∏™‡∏π‡πà‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡∏Ñ‡∏≤‡∏î‡∏Ñ‡∏¥‡∏î‡∏°‡∏≤‡∏Å‡πà‡∏≠‡∏ô ‡∏à‡∏∞‡πÄ‡∏Å‡∏¥‡∏î‡∏≠‡∏∞‡πÑ‡∏£‡∏Ç‡∏∂‡πâ‡∏ô? ‡∏î‡∏π‡πÄ‡∏•‡∏¢!"

---

## ‚õî ‡∏Ç‡πâ‡∏≠‡∏´‡πâ‡∏≤‡∏° (DON'T)
- ‚ùå summary ‡πÑ‡∏°‡πà‡∏°‡∏µ [PARA] ‡∏Ñ‡∏±‡πà‡∏ô‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤ (REJECT!)
- ‚ùå summary ‡∏™‡∏±‡πâ‡∏ô‡∏Å‡∏ß‡πà‡∏≤ 400 ‡∏Ñ‡∏≥
- ‚ùå summaryShort ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÅ‡∏ö‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô/‡∏™‡∏≤‡∏£‡∏Ñ‡∏î‡∏µ (‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏∑‡πà‡∏ô‡πÄ‡∏ï‡πâ‡∏ô!)
- ‚ùå ‡∏ú‡∏™‡∏°‡∏†‡∏≤‡∏©‡∏≤‡πÉ‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÅ‡∏™‡∏î‡∏á
- ‚ùå mainTheme/mainTone ‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤
`,
		input.SRTContent,
		input.VideoMetadata.RealCode,
		input.VideoMetadata.Duration,
		castNamesStr,
		castNamesStr,
		input.VideoMetadata.RealCode,
	)
}
